# 如果缓存更新和数据库更新都不会失败

## Cache Aside Pattern

* 命中：将缓存中的数据返回
* 失效：将数据库中的数据读取出来，然后更新缓存
* 更新：先更新数据库中的数据，然后将缓存失效

为什么是将缓存失效，而不是将缓存更新？     
* 缓存更新会因为并发写，导致更新数据为旧的     

更新数据将缓存失效，不会造成脏数据么？     
* 读和写并发的时候，会造成脏数据，概率低     

## Read/Write Through Pattern

Read/Write Through 是让上层业务看起来像维护一个存储一样，而存储自己维护自己的Cache

### Read Through 

读穿透，是在查询的时候穿透缓存，将存储中的数据更新到缓存中。

### Write Through 

写穿透，是在更新数据的时候更新缓存，更新缓存的操作托管给底层存储


## Write Behind Cache Pattern

一句话描述就是只更新缓存，缓存自己更新存储，这样设计的好处就是I/O快的飞起，而且因为异步，会让更新存储的操作做merge操作，将多次更新归并成一次，但同样会发生因为down机导致的数据不一致，但软件设计从来都没有一个完美的解决方案，都是取舍。       


## 参考资料      

* [https://coolshell.cn/articles/17416.html](https://coolshell.cn/articles/17416.html)
